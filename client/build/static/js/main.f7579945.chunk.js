(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{127:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=127},128:function(e,t,n){"use strict";n.r(t);var c=n(1),l=n(28),s=n.n(l),a=n(8),r=(n(74),n(4)),i=n(3),o=n(5),u=n(130),d=n(25),b=n.n(d),j=n(38),m=n(18),x=n(66),f=n.n(x).a.create({baseURL:"http://localhost:5000",headers:{"Content-Type":"application/json; charset=UTF-8"}});f.interceptors.response.use((function(e){return e}),(function(e){return e.response.status,Promise.reject(e)}));var h=f,g=function(e){e?(h.defaults.headers.common["x-auth-token"]=e,localStorage.setItem("token",e)):(delete h.defaults.headers.common["x-auth-token"],localStorage.removeItem("token"))},p=Object(m.b)("auth/fetchUser",Object(j.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.get("/auth");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})))),O=Object(m.b)("auth/userLogin",function(){var e=Object(j.a)(b.a.mark((function e(t){var n,c,l;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.email,c=t.password,e.next=3,h.post("/login",{email:n,password:c});case 3:return l=e.sent,e.abrupt("return",l.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),v=Object(m.c)({name:"auth",initialState:{isAuthenticated:!1,user:null,loading:!1},reducers:{authLogout:function(e,t){e.loading=!1,e.isAuthenticated=!1,e.user=null,g("")}},extraReducers:function(e){e.addCase(p.pending,(function(e,t){e.loading=!0,e.isAuthenticated=!1})).addCase(p.fulfilled,(function(e,t){e.loading=!1,t.payload.message||(e.isAuthenticated=!0,e.user=t.payload)})).addCase(p.rejected,(function(e,t){e.loading=!1})).addCase(O.pending,(function(e,t){e.loading=!0})).addCase(O.fulfilled,(function(e,t){e.loading=!1,t.payload&&(g(t.payload.token),e.user=t.payload.user,e.isAuthenticated=!0)})).addCase(O.rejected,(function(e,t){e.loading=!1}))}}),w=v.actions.authLogout,y=v.reducer,N=n(0);var k=function(){var e=Object(c.useState)(),t=Object(r.a)(e,2),n=t[0],l=t[1],s=Object(o.c)((function(e){return e.auth.user})),d=Object(o.b)();return Object(c.useEffect)((function(){l(Object(u.a)())}),[]),s?Object(N.jsx)("div",{className:"flex h-full bg-img-background bg-cover bg-no-repeat w-full justify-center items-center",children:Object(N.jsx)("div",{className:"flex w-1/2 h-full items-center justify-center",children:Object(N.jsxs)("div",{className:"w-3/4",children:[Object(N.jsxs)("div",{className:"flex justify-center",children:[Object(N.jsx)(a.b,{to:"/join",className:"flex justify-end min-w-3/4 mr-6",children:Object(N.jsxs)("button",{className:"justify-center flex min-w-1/2 items-center bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full focus:outline-none",children:[Object(N.jsx)("svg",{width:"2em",height:"2em",viewBox:"0 0 24 24",children:Object(N.jsx)("path",{d:"M3.7 7.7a.996.996 0 0 1 1.41 0L12 14.59l4.29-4.3L14.7 8.7c-.62-.62-.18-1.7.71-1.7H20c.55 0 1 .45 1 1v4.59c0 .89-1.08 1.34-1.71.71l-1.59-1.59l-5 5a.996.996 0 0 1-1.41 0L3.7 9.11c-.38-.38-.38-1.02 0-1.41z",fill:"currentColor"})}),Object(N.jsx)("div",{children:"Join meeting"})]})}),Object(N.jsx)(a.b,{to:"/rooms/".concat(n),className:"flex justify-start min-w-3/4 ml-6",children:Object(N.jsxs)("button",{className:"justify-center focus:outline-none min-w-1/2 flex items-center bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full",children:[Object(N.jsx)("svg",{width:"2em",height:"2em",viewBox:"0 0 24 24",children:Object(N.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z",fill:"currentColor"})}),Object(N.jsx)("div",{children:Object(N.jsx)("div",{children:"Create a meeting"})})]})})]}),Object(N.jsx)("div",{className:"flex justify-center mt-6",children:Object(N.jsx)("div",{className:"text-white text-xl text hover:underline cursor-pointer",children:Object(N.jsx)("button",{className:"focus:outline-none",onClick:function(){return d(w())},children:"Logout"})})})]})})}):Object(N.jsx)(i.a,{to:"/login"})};var C=function(){var e=Object(c.useState)(""),t=Object(r.a)(e,2),n=t[0],l=t[1],s=Object(c.useState)(""),u=Object(r.a)(s,2),d=u[0],b=u[1],j=Object(o.c)((function(e){return e.auth.isAuthenticated})),m=Object(o.b)();function x(e){"email"===e.target.id?l(e.target.value):b(e.target.value)}return j?Object(N.jsx)(i.a,{to:"/"}):Object(N.jsx)("div",{className:"w-full h-full bg-img-background bg-cover bg-no-repeat",children:Object(N.jsx)("div",{className:"w-full h-full flex justify-center items-center md:block",children:Object(N.jsx)("div",{className:"h-full md:w-1/3 w-3/4 min-w-min px-3 bg-white bg-opacity-50 shadow-2xl flex items-center justify-center",children:Object(N.jsx)("form",{className:"flex flex-col items-center justify-center sm:justify-start rounded",onSubmit:function(e){e.preventDefault(),m(O({email:n,password:d}))},children:Object(N.jsxs)("div",{className:"flex flex-col justify-center text-xl",children:[Object(N.jsx)("div",{className:"text-6xl md:text-4xl xl:text-5xl 2xl:text-7xl mb-12 flex justify-center",children:"Sign in"}),Object(N.jsxs)("div",{className:"mb-4",children:[Object(N.jsx)("label",{className:"block text-gray-700 font-bold mb-2",htmlFor:"email",children:"Email"}),Object(N.jsx)("input",{className:"shadow text-lg appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",id:"email",type:"text",placeholder:"Email",onChange:x,value:n})]}),Object(N.jsxs)("div",{className:"",children:[Object(N.jsx)("label",{className:"block text-gray-700 font-bold mb-2",htmlFor:"password",children:"Password"}),Object(N.jsx)("input",{className:"shadow text-lg appearance-none border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline",id:"password",type:"password",placeholder:"******************",onChange:x,value:d})]}),Object(N.jsxs)("div",{className:"flex text-xs xl:text-sm 2xl:text-base",children:[Object(N.jsx)("div",{className:"text-black text-opacity-60 mr-2",children:"If you don't have account ?"}),Object(N.jsx)("div",{children:Object(N.jsx)(a.b,{to:"/register",className:"text-blue-500",children:"Sign up"})})]}),Object(N.jsx)("div",{className:"flex items-center justify-center mt-2",children:Object(N.jsx)("button",{className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline",type:"submit",children:"Sign In"})})]})})})})})},S=n(31),E=n(32);var A=function(){var e=Object(c.useState)({}),t=Object(r.a)(e,2),n=t[0],l=t[1],s=Object(c.useState)(!1),o=Object(r.a)(s,2),u=o[0],d=o[1];function b(e){l(Object(E.a)(Object(E.a)({},n),{},Object(S.a)({},e.target.id,e.target.value)))}return u?Object(N.jsx)(i.a,{to:"/login"}):Object(N.jsx)("div",{className:"h-full bg-img-background bg-cover bg-no-repeat flex justify-center md:block",children:Object(N.jsx)("div",{className:"h-full w-3/4 md:w-1/3 items-center flex justify-center bg-white bg-opacity-50 shadow-2xl rounded px-4",children:Object(N.jsxs)("form",{className:"max-w-lg text-xl",autoComplete:"off",onSubmit:function(e){e.preventDefault(),h.post("/register",Object(E.a)({},n)).then((function(e){e.msg||d(!0)}))},children:[Object(N.jsx)("div",{className:"text-6xl md:text-4xl xl:text-5xl 2xl:text-7xl mb-12 flex justify-center",children:"Sign up"}),Object(N.jsxs)("div",{className:"mb-4",children:[Object(N.jsx)("label",{className:"block text-gray-700 font-bold mb-2",htmlFor:"name",children:"Full name"}),Object(N.jsx)("input",{className:"text-lg appearance-none block w-full bg-gray-200 text-gray-700 border border-gray-200 rounded py-3 px-4 leading-tight focus:outline-none focus:bg-white",id:"name",type:"text",placeholder:"Name",onChange:b})]}),Object(N.jsxs)("div",{className:"mb-4",children:[Object(N.jsx)("label",{className:"block text-gray-700 font-bold mb-2",htmlFor:"email",children:"Email"}),Object(N.jsx)("input",{className:"text-lg appearance-none block w-full bg-gray-200 text-gray-700 border border-gray-200 rounded py-3 px-4 leading-tight focus:outline-none focus:bg-white",id:"email",type:"text",placeholder:"Email",onChange:b})]}),Object(N.jsx)("div",{className:"flex flex-wrap -mx-3",children:Object(N.jsxs)("div",{className:"w-full px-3",children:[Object(N.jsx)("label",{className:"block tracking-wide text-gray-700 font-bold mb-2",htmlFor:"password",children:"Password"}),Object(N.jsx)("input",{className:"text-lg appearance-none block w-full bg-gray-200 text-gray-700 border border-gray-200 rounded py-3 px-4 mb-3 leading-tight focus:outline-none focus:bg-white",id:"password",type:"password",placeholder:"******************",onChange:b})]})}),Object(N.jsxs)("div",{className:"flex text-xs xl:text-sm 2xl:text-base mb-1",children:[Object(N.jsx)("div",{className:"text-black text-opacity-60 mr-2",children:"If you have account ?"}),Object(N.jsx)("div",{children:Object(N.jsx)(a.b,{to:"/login",className:"text-blue-500",children:"Login"})})]}),Object(N.jsx)("div",{className:"flex items-center justify-center",children:Object(N.jsx)("button",{className:"bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline",type:"submit",children:"Sign up"})})]})})})},M=n(67),I=n.n(M),z=n(68),L=n.n(z),B=n(69);var D=function(e){var t=e.room,n=e.socket,l=Object(c.useState)([]),s=Object(r.a)(l,2),a=s[0],i=s[1],u=Object(c.useState)(""),d=Object(r.a)(u,2),b=d[0],j=d[1],m=Object(o.c)((function(e){return e.user}));return Object(c.useEffect)((function(){return n&&n.on("message",(function(e){i([].concat(Object(B.a)(a),[e]));var t=document.getElementById("messages");t.scrollTop=t.scrollHeight})),function(){null===n||void 0===n||n.off("message")}})),Object(N.jsxs)("div",{className:"h-full w-full",children:[Object(N.jsx)("div",{className:"h-full mx-2",children:Object(N.jsx)("div",{id:"messages",className:"h-full pb-16 text-sm pt-2 overflow-y-auto no-scrollbar",children:Object(N.jsx)("div",{className:"",children:null===a||void 0===a?void 0:a.map((function(e,t){return function(e,t){return"Admin"!==e.name?Object(N.jsx)("div",{className:e.name===m.name?"flex justify-end":"flex justify-start",children:Object(N.jsxs)("div",{className:e.name===m.name?"w-auto max-w-full inline-block p-2 rounded-xl bg-blue-500 my-1 text-white":"w-auto max-w-full inline-block p-2 rounded-xl bg-gray-400 my-1",children:[Object(N.jsx)("p",{className:"text-xs font-bold w-auto max-w-full",children:e.name}),Object(N.jsx)("p",{className:"w-auto max-w-full",children:e.msg})]},t)}):Object(N.jsx)("div",{className:"flex justify-center text-gray-400",children:e.msg},t)}(e,t)}))})})}),Object(N.jsx)("div",{className:"fixed bottom-0 w-1/4 bg-white",children:Object(N.jsxs)("form",{className:"h-16 w-full flex border-t p-2 items-center justify-center",onSubmit:function(e){e.preventDefault(),b&&n&&(n.emit("sendMessage",{name:m.name,msg:b,room:t}),j(""))},children:[Object(N.jsx)("div",{className:"h-full w-11/12 p-1 flex items-center",children:Object(N.jsx)("input",{type:"text",name:"message",autoComplete:"off",placeholder:"Ab",value:b,onChange:function(e){e.preventDefault(),j(e.target.value)},className:"h-full w-full text-xs no-scrollbar resize-none outline-none border-gray-400 border rounded-full p-2"})}),Object(N.jsx)("div",{className:"h-full flex items-center w-1/12 text-2xl mr-2",children:Object(N.jsx)("button",{type:"submit",className:"focus:outline-none",children:Object(N.jsx)("svg",{width:"1em",height:"1em",viewBox:"0 0 15 15",children:Object(N.jsx)("g",{fill:"none",children:Object(N.jsx)("path",{d:"M14.5.5l.46.197a.5.5 0 0 0-.657-.657L14.5.5zm-14 6l-.197-.46a.5.5 0 0 0-.06.889L.5 6.5zm8 8l-.429.257a.5.5 0 0 0 .889-.06L8.5 14.5zM14.303.04l-14 6l.394.92l14-6l-.394-.92zM.243 6.93l5 3l.514-.858l-5-3l-.514.858zM5.07 9.757l3 5l.858-.514l-3-5l-.858.514zm3.889 4.94l6-14l-.92-.394l-6 14l.92.394zM14.146.147l-9 9l.708.707l9-9l-.708-.708z",fill:"currentColor"})})})})})]})})]})};var R=function(){var e=Object(o.c)((function(e){return e.auth.loading})),t=Object(o.c)((function(e){return e.auth.isAuthenticated})),n=Object(c.useState)(Object(i.g)().id),l=Object(r.a)(n,1)[0],s=Object(o.c)((function(e){return e.auth.user})),a=Object(c.useState)((function(){return I()("http://localhost:5000",{transports:["websocket"],upgrade:!1})})),u=Object(r.a)(a,1)[0],d=Object(c.useState)(),b=Object(r.a)(d,2),j=b[0],m=b[1],x=Object(c.useState)([]),f=Object(r.a)(x,2),h=f[0],g=f[1],p=Object(c.useState)((function(){return new L.a({config:{iceServers:[{urls:["stun:ss-turn1.xirsys.com"]},{username:"Dc7ggNOIfRrrSBHsJ4QRfdtGsk0KSdvQR4vDjpRw800C9zQUuqOajzBquMCZp2lHAAAAAGBismBsZXRoYW5odmlldA==",credential:"02cacc36-9116-11eb-a0d5-0242ac140004",urls:["turn:ss-turn1.xirsys.com:80?transport=udp","turn:ss-turn1.xirsys.com:3478?transport=udp","turn:ss-turn1.xirsys.com:80?transport=tcp","turn:ss-turn1.xirsys.com:3478?transport=tcp","turns:ss-turn1.xirsys.com:443?transport=tcp","turns:ss-turn1.xirsys.com:5349?transport=tcp"]}]}})})),O=Object(r.a)(p,1)[0];if(Object(c.useEffect)((function(){null===O||void 0===O||O.on("open",(function(e){m(e),u.emit("joinRoom",{name:null===s||void 0===s?void 0:s.name,room:l,peerID:e}),u.on("allMembers",(function(t){var n=document.getElementById("videoContainer");n&&(n.innerHTML=""),navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((function(n){w(e,n,!0),t.forEach((function(t){if(t!==e){var c=O.call(t,n);null===c||void 0===c||c.on("stream",(function(e){w(t,e)}))}})),v(t)})),O.on("call",(function(c){n&&(n.innerHTML=""),navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((function(n){c.answer(n),w(e,n,!0),t.forEach((function(t){t!==e&&(null===c||void 0===c||c.on("stream",(function(e){w(t,e)})))})),v(t)}))})),g(t)}))}))}),[u,l,s,O,h]),Object(c.useEffect)((function(){return function(){null===u||void 0===u||u.emit("peerClose",{peerId:j})}}),[u,j]),Object(c.useEffect)((function(){v(h)}),[h]),!t&&!e)return Object(N.jsx)(i.a,{to:"/login"});function v(e){for(var t=document.getElementById("videoContainer"),n=[],c=0;c<t.childNodes.length;c++)e.includes(t.childNodes[c].id)||n.push(t.childNodes[c]),console.log(n);n.forEach((function(e){t.removeChild(e)}))}function w(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!document.getElementById(e)){var c=document.createElement("video"),l=document.createElement("div"),s=document.getElementById("videoContainer");l.className="max-w-full min-w-min flex justify-center items-center",c.srcObject=t,n&&(c.muted="muted"),l.id=e;var a=c.play();void 0!==a&&a.then((function(e){})).catch((function(e){console.log(e)})),l.appendChild(c),s&&s.appendChild(l)}}return Object(N.jsxs)("div",{className:"w-full h-full flex",children:[Object(N.jsx)("div",{className:"w-full sm:w-3/4 h-full no-scrollbar grid grid-cols-2 gap-2 overflow-y-scroll bg-black bg-opacity-90 p-2",id:"videoContainer"}),Object(N.jsx)("div",{className:"w-1/4 hidden sm:block h-full border-l border-gray-300",children:Object(N.jsx)(D,{room:l,socket:u})})]})};var F=function(){var e=Object(c.useState)(),t=Object(r.a)(e,2),n=t[0],l=t[1];return Object(N.jsx)("div",{className:"w-full h-full flex justify-center items-center bg-img-background bg-cover bg-no-repeat",children:Object(N.jsxs)("div",{children:[Object(N.jsx)("div",{className:"text-white text-5xl mb-4",children:"Join A Room"}),Object(N.jsx)("div",{children:Object(N.jsxs)("form",{children:[Object(N.jsx)("input",{name:"id",type:"text",value:n,onChange:function(e){e.preventDefault(),l(e.target.value)},placeholder:"Enter room's id ...",className:"rounded-lg p-4 focus:outline-none"}),Object(N.jsx)(a.b,{to:"/rooms/".concat(n),children:Object(N.jsx)("button",{type:"submit",className:"bg-blue-500 text-white ml-4 text-xl p-2 rounded-xl",children:"JOIN"})})]})})]})})};var H=function(){return Object(N.jsx)("div",{className:"w-full h-full flex justify-center items-center text-white bg-img-background bg-cover bg-no-repeat",children:Object(N.jsx)("div",{children:Object(N.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink","aria-hidden":"true",role:"img",className:"animate-spin iconify iconify--mdi-light",width:"200",height:"200",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24",children:Object(N.jsx)("path",{d:"M11.5 4A8.5 8.5 0 0 0 3 12.5H2A9.5 9.5 0 0 1 11.5 3v1z",fill:"currentColor"})})})})};var U=function(){var e=Object(o.c)((function(e){return e.auth.loading})),t=Object(o.b)(),n=Object(c.useState)(!0),l=Object(r.a)(n,2),s=l[0],a=l[1];return Object(c.useEffect)((function(){var e=localStorage.getItem("token");g(e),t(p()),a(!1)}),[t]),e||s?Object(N.jsx)(H,{}):Object(N.jsx)("div",{className:"App h-full font-custom",children:Object(N.jsxs)(i.d,{children:[Object(N.jsx)(i.b,{path:"/login",exact:!0,component:C}),Object(N.jsx)(i.b,{path:"/register",exact:!0,component:A}),Object(N.jsx)(i.b,{path:"/rooms/:id",component:R}),Object(N.jsx)(i.b,{path:"/join",exact:!0,component:F}),Object(N.jsx)(i.b,{path:"/",exact:!0,component:k})]})})},J=Object(m.a)({reducer:{auth:y},middleware:Object(m.d)({serializableCheck:!1})});s.a.render(Object(N.jsx)(a.a,{children:Object(N.jsx)(o.a,{store:J,children:Object(N.jsx)(U,{})})}),document.getElementById("root"))},74:function(e,t,n){}},[[128,1,2]]]);
//# sourceMappingURL=main.f7579945.chunk.js.map